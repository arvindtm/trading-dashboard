<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Trading Dashboard | Nasdaq Futures</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif; background: #0d1117; color: #e6edf3; min-height: 100vh; padding: 20px; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; padding-bottom: 20px; border-bottom: 1px solid #21262d; }
        .header h1 { font-size: 24px; color: #58a6ff; }
        .last-updated { color: #8b949e; font-size: 14px; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { background: #161b22; border: 1px solid #21262d; border-radius: 12px; padding: 20px; }
        .card h2 { font-size: 14px; text-transform: uppercase; letter-spacing: 1px; color: #8b949e; margin-bottom: 15px; display: flex; align-items: center; gap: 8px; }
        .level-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #21262d; font-size: 14px; }
        .level-item:last-child { border-bottom: none; }
        .level-label { color: #8b949e; }
        .level-value { font-weight: 600; }
        .level-value.resistance { color: #f85149; }
        .level-value.support { color: #3fb950; }
        .event-item { display: flex; gap: 15px; padding: 10px 0; border-bottom: 1px solid #21262d; font-size: 14px; }
        .event-item:last-child { border-bottom: none; }
        .event-time { color: #58a6ff; min-width: 80px; }
        .event-impact { padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; }
        .event-impact.high { background: #f8514933; color: #f85149; }
        .event-impact.medium { background: #d2992233; color: #d29922; }
        .earnings-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #21262d; font-size: 14px; }
        .earnings-item:last-child { border-bottom: none; }
        .ticker { font-weight: 700; color: #58a6ff; }
        .news-item { padding: 8px 0; border-bottom: 1px solid #21262d; font-size: 13px; }
        .news-item:last-child { border-bottom: none; }
        .news-source { color: #8b949e; font-size: 12px; }
        .status-indicator { display: inline-block; width: 8px; height: 8px; border-radius: 50%; background: #3fb950; margin-right: 8px; animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.5; } }
        .market-status { display: flex; align-items: center; gap: 15px; margin-bottom: 20px; padding: 15px; background: #161b22; border-radius: 8px; }
        .market-closed { color: #f85149; }
        .market-open { color: #3fb950; }
        .risk-item { display: flex; align-items: center; gap: 10px; padding: 10px 0; border-bottom: 1px solid #21262d; font-size: 13px; }
        .risk-item:last-child { border-bottom: none; }
        .risk-icon { font-size: 18px; }
        .risk-text { flex: 1; }
        .risk-badge { padding: 2px 8px; border-radius: 4px; font-size: 11px; font-weight: 600; }
        .risk-badge.high { background: #f8514933; color: #f85149; }
        .risk-badge.medium { background: #d2992233; color: #d29922; }
        .sentiment-bar { height: 8px; background: #21262d; border-radius: 4px; margin-top: 10px; overflow: hidden; }
        .sentiment-fill { height: 100%; border-radius: 4px; }
        .sentiment-fill.bearish { background: #f85149; }
        .sentiment-fill.bullish { background: #3fb950; }
        .sentiment-fill.neutral { background: #d29922; }
        .vix-display { font-size: 28px; font-weight: 700; color: #58a6ff; margin-bottom: 5px; }
        .vix-label { color: #8b949e; font-size: 12px; margin-bottom: 10px; }
        .global-index-item { display: flex; align-items: center; justify-content: space-between; padding: 12px; background: #0d1117; border-radius: 8px; margin-bottom: 8px; }
        .index-info { display: flex; align-items: center; gap: 10px; }
        .index-icon { font-size: 20px; }
        .index-name { font-weight: 600; font-size: 14px; }
        .index-price { font-weight: 700; color: #58a6ff; font-size: 14px; }
        .index-change { font-weight: 600; font-size: 13px; padding: 4px 8px; border-radius: 4px; }
        .index-change.up { background: #3fb95033; color: #3fb950; }
        .index-change.down { background: #f8514933; color: #f85149; }
        .market-hours-grid { display: grid; grid-template-columns: repeat(2, 1fr); gap: 10px; margin-bottom: 15px; }
        .hour-item { text-align: center; padding: 10px; background: #0d1117; border-radius: 8px; }
        .hour-value { font-size: 16px; font-weight: 700; color: #58a6ff; }
        .hour-label { font-size: 10px; color: #8b949e; text-transform: uppercase; }
        .external-link { display: block; text-align: center; padding: 12px; background: #0d1117; border-radius: 8px; color: #58a6ff; font-size: 13px; text-decoration: none; margin-top: 10px; }
        .external-link:hover { background: #21262d; }
        .trade-card { background: #0d1117; border-radius: 8px; padding: 15px; margin-bottom: 12px; border-left: 4px solid; }
        .trade-card.long { border-left-color: #3fb950; }
        .trade-card.short { border-left-color: #f85149; }
        .trade-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .trade-direction { font-weight: 700; font-size: 14px; }
        .trade-direction.long { color: #3fb950; }
        .trade-direction.short { color: #f85149; }
        .trade-badge { padding: 2px 8px; border-radius: 4px; font-size: 11px; background: #21262d; color: #8b949e; }
        .trade-row { display: flex; justify-content: space-between; font-size: 13px; margin-bottom: 5px; }
        .trade-label { color: #8b949e; }
        .trade-value { font-weight: 600; }
        .trade-target { color: #3fb950; }
        .trade-stop { color: #f85149; }
        .trade-rationale { font-size: 12px; color: #8b949e; margin-top: 8px; font-style: italic; }
        .indicator-row { display: flex; justify-content: space-between; padding: 6px 0; border-bottom: 1px solid #21262d; font-size: 13px; }
        .indicator-row:last-child { border-bottom: none; }
        .indicator-name { color: #8b949e; }
        .indicator-value { font-weight: 600; }
        .indicator-value.bullish { color: #3fb950; }
        .indicator-value.bearish { color: #f85149; }
        .indicator-value.neutral { color: #d29922; }
        .session-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #21262d; font-size: 13px; }
        .session-item:last-child { border-bottom: none; }
        .session-name { display: flex; align-items: center; gap: 8px; }
        .session-icon { font-size: 16px; }
        .session-levels { display: flex; gap: 10px; }
        .session-hl { padding: 2px 6px; background: #0d1117; border-radius: 4px; font-size: 12px; }
        .session-hl.up { color: #3fb950; }
        .session-hl.down { color: #f85149; }
        .profile-bar { height: 20px; display: flex; border-radius: 4px; overflow: hidden; margin: 10px 0; }
        .profile-bar div { height: 100%; }
        .profile-bar .buy { background: #3fb950; }
        .profile-bar .sell { background: #f85149; }
        .profile-bar .neutral { background: #21262d; }
        .gap-item { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 1px solid #21262d; font-size: 13px; }
        .gap-item:last-child { border-bottom: none; }
        .gap-fill { font-weight: 600; }
        .gap-fill.filled { color: #3fb950; }
        .gap-fill.pending { color: #d29922; }
        .breadth-item { display: flex; justify-content: space-between; padding: 6px 0; font-size: 13px; }
        .breadth-bar { height: 6px; background: #21262d; border-radius: 3px; margin-top: 4px; overflow: hidden; }
        .breadth-bar-fill { height: 100%; border-radius: 3px; }
        .breadth-bar-fill.up { background: #3fb950; }
        .breadth-bar-fill.down { background: #f85149; }
        .card { cursor: grab; transition: transform 0.2s, box-shadow 0.2s, opacity 0.2s; }
        .card:active { cursor: grabbing; }
        .card.sortable-ghost { opacity: 0.5; }
        .card.sortable-drag { opacity: 1; }
        .grid.locked .card { cursor: not-allowed; }
        .drag-handle { display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px; }
        .drag-icon { color: #484f58; font-size: 16px; cursor: grab; }
        /* Side Tab for Non-Trading */
        .side-tab { position: fixed; right: 0; top: 50%; transform: translateY(-50%); z-index: 1000; }
        .side-tab-btn { width: 40px; height: 120px; background: #161b22; border: 1px solid #21262d; border-right: none; border-radius: 8px 0 0 8px; color: #58a6ff; cursor: pointer; writing-mode: vertical-rl; text-orientation: mixed; font-size: 12px; padding: 10px 5px; }
        .side-tab-btn:hover { background: #21262d; }
        .side-panel { position: fixed; right: -320px; top: 0; width: 320px; height: 100vh; background: #0d1117; border-left: 1px solid #21262d; padding: 20px; transition: right 0.3s ease; overflow-y: auto; z-index: 999; }
        .side-panel.open { right: 0; }
        .side-panel h2 { font-size: 16px; color: #58a6ff; margin-bottom: 15px; display: flex; justify-content: space-between; align-items: center; }
        .side-panel-close { background: none; border: none; color: #8b949e; font-size: 20px; cursor: pointer; }
        .side-section { margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #21262d; }
        .side-section h3 { font-size: 13px; color: #8b949e; margin-bottom: 10px; text-transform: uppercase; letter-spacing: 1px; }
        .side-item { display: flex; justify-content: space-between; padding: 6px 0; font-size: 13px; }
        .ao-match { padding: 8px; background: #161b22; border-radius: 6px; margin-bottom: 8px; }
        .ao-match-player { display: flex; justify-content: space-between; }
        .ao-score { font-weight: 700; color: #58a6ff; }
        .weather-item { display: flex; align-items: center; gap: 10px; margin-bottom: 8px; }
        .weather-icon { font-size: 24px; }
        .weather-temp { font-size: 18px; font-weight: 700; color: #58a6ff; }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/sortablejs@latest/Sortable.min.js"></script>
</head>
<body>
    <div class="header">
        <h1>üöÄ Trading Dashboard</h1>
        <div>
            <span class="status-indicator"></span>
            <span class="last-updated">Last updated: <span id="updateTime">--:--</span>
            <button id="lockBtn" onclick="toggleLock()" style="margin-left: 15px; padding: 5px 12px; background: #21262d; border: 1px solid #30363d; border-radius: 6px; color: #8b949e; cursor: pointer; font-size: 12px;">üîì Unlock</button>
        </div>
    </div>
    <div class="market-status" id="marketStatus">
        <div id="marketTimer" style="margin-left: auto; font-size: 14px; font-weight: 600;"></div>
    </div>
    <div class="grid" id="dashboardGrid">
        <!-- NQ Levels -->
        <div class="card">
            <h2>üìà NQ Levels</h2>
            <a href="https://www.tradingview.com/chart/NQ1/?symbol=CME_MINI:NQ1!" target="_blank" class="external-link">üìä View Chart on TradingView</a>
            <div class="level-item"><span class="level-label">Current</span><span class="level-value" id="price">--</span></div>
            <div class="level-item"><span class="level-label">R1</span><span class="level-value resistance" id="res1">--</span></div>
            <div class="level-item"><span class="level-label">R2</span><span class="level-value resistance" id="res2">--</span></div>
            <div class="level-item"><span class="level-label">S1</span><span class="level-value support" id="sup1">--</span></div>
            <div class="level-item"><span class="level-label">S2</span><span class="level-value support" id="sup2">--</span></div>
        </div>
        <!-- Trade Ideas -->
        <div class="card">
            <h2>üéØ Trade Ideas (Jan 26)</h2>
            <div id="tradeIdeas"></div>
        </div>
        <!-- London Open Strategy -->
        <div class="card">
            <h2>üá¨üáß London Open (6AM EST)</h2>
            <div id="londonOpen"></div>
        </div>
        <!-- Price Alerts -->
        <div class="card">
            <h2>üîî Price Alerts</h2>
            <div id="priceAlerts"></div>
        </div>
        <!-- Session Levels -->
        <div class="card">
            <h2>üåè Session Levels (NQ)</h2>
            <div id="sessionLevels"></div>
        </div>
        <!-- Volume Profile -->
        <div class="card">
            <h2>üìä Volume Profile</h2>
            <div id="volumeProfile"></div>
        </div>
        <!-- VIX & Volatility -->
        <div class="card">
            <h2>üìâ VIX & Volatility</h2>
            <div id="vixData"></div>
        </div>
        <!-- Gap Analysis -->
        <div class="card">
            <h2>üì≠ Gap Analysis</h2>
            <div id="gapData"></div>
        </div>
        <!-- ADR -->
        <div class="card">
            <h2>üìè ADR & ATR</h2>
            <div id="adrData"></div>
        </div>
        <!-- Options Data -->
        <div class="card">
            <h2>üìä Options Flow</h2>
            <div id="optionsData"></div>
        </div>
        <!-- Open Interest -->
        <div class="card">
            <h2>üìà Open Interest (NQ)</h2>
            <div id="oiData"></div>
        </div>
        <!-- DXY Correlation -->
        <div class="card">
            <h2>üíµ DXY & Correlation</h2>
            <div id="dxyData"></div>
        </div>
        <!-- Market Breadth -->
        <div class="card">
            <h2>üìä Market Breadth</h2>
            <div id="breadthData"></div>
        </div>
        <!-- Technical Indicators -->
        <div class="card">
            <h2>üìä Technical Indicators</h2>
            <div id="indicators"></div>
        </div>
        <!-- Global Indices -->
        <div class="card">
            <h2>üåç Global Indices</h2>
            <div id="globalIndices"></div>
        </div>
        <!-- NIFTY India -->
        <div class="card">
            <h2>üáÆüá≥ NIFTY 50 (India)</h2>
            <div id="niftyData"></div>
        </div>
        <!-- Liquidation Candles -->
        <div class="card">
            <h2>üî• Liquidation Candles</h2>
            <div id="liquidationData"></div>
        </div>
        <!-- Market Movers -->
        <div class="card">
            <h2>‚ö†Ô∏è Market Movers</h2>
            <div id="marketRisks"></div>
        </div>
        <!-- Economic Events -->
        <div class="card">
            <h2>üìÖ Economic Events</h2>
            <div id="economicEvents"></div>
        </div>
        <!-- Earnings -->
        <div class="card">
            <h2>üí∞ Earnings This Week</h2>
            <div id="earnings"></div>
        </div>
        <!-- News -->
        <div class="card">
            <h2>üì∞ Market News</h2>
            <div id="news"></div>
        </div>
    </div>
    <script>
        const UPDATE_INTERVAL = 30 * 1000; // 30 seconds (Finnhub: 60 req/min)
        
        let cachedPrices = { tsla: null, nq: null, vix: null, dxy: null, lastFetch: 0 };
        // Finnhub API (free tier: 60 requests/minute)
        const FINNHUB_KEY = 'd5rkr2pr01qln7b668tgd5rkr2pr01qln7b668u0';
        
        // Default fallback values (always works)
        const DEFAULT_PRICES = {
            tsla: { current: 449.06, change: -0.07 },
            nq: { current: 25650, change: 0.12 },
            vix: { current: 16.5, change: -2.1 },
            dxy: { current: 108.5, change: 0.15 }
        };
        
        async function fetchFromFinnhub(symbol) {
            try {
                const url = `https://finnhub.io/api/v1/quote?symbol=${symbol}&token=${FINNHUB_KEY}`;
                const res = await fetch(url);
                if (!res.ok) throw new Error('Network error');
                const data = await res.json();
                if (data && data.c > 0) {
                    return { current: data.c, change: data.dp || 0 };
                }
            } catch (e) {
                console.log(`Finnhub fetch failed for ${symbol}`);
            }
            return null;
        }
        
        async function fetchPrices() {
            // Always show defaults first (instant load)
            let prices = { ...DEFAULT_PRICES, nifty: DEFAULT_NIFTY };
            
            // Try to fetch live data in background
            try {
                const [tsla, qqq] = await Promise.all([
                    fetchFromFinnhub('TSLA'),
                    fetchFromFinnhub('QQQ')
                ]);
                if (tsla) prices.tsla = tsla;
                if (qqq) prices.nq = { current: Math.round(qqq.current * 50), change: qqq.change };
                
                // Try to fetch NIFTY from Yahoo Finance via proxy
                try {
                    const niftyRes = await fetch('https://query1.finance.yahoo.com/v8/finance/chart/%5ENSEI?interval=1d');
                    const niftyData = await niftyRes.json();
                    const niftyCurrent = niftyData?.chart?.result?.[0]?.indicators?.quote?.[0]?.close?.[0];
                    if (niftyCurrent && niftyCurrent > 0) {
                        prices.nifty = { 
                            current: Math.round(niftyCurrent), 
                            change: 0,
                            high: Math.round(niftyCurrent * 1.005),
                            low: Math.round(niftyCurrent * 0.995),
                            open: Math.round(niftyCurrent * 1.01)
                        };
                    }
                } catch (e) {
                    console.log('NIFTY fetch failed, using defaults');
                }
            } catch (e) {
                console.log('Live fetch failed, using defaults');
            }
            
            console.log('Current prices:', prices);
            return prices;
        }
        
        function updateTradeIdeas() {
            const tradeIdeas = [
                { direction: 'LONG', type: 'Pullback Buy', entry: '25,400 - 25,450', stop: '25,350', target1: '25,550', target2: '25,650', rationale: 'Demand zone, MA 200 support' },
                { direction: 'SHORT', type: 'Rejection Short', entry: '25,850 - 26,000', stop: '26,050', target1: '25,700', target2: '25,600', rationale: 'Supply zone, H&S pattern' },
            ];
            document.getElementById('tradeIdeas').innerHTML = tradeIdeas.map(trade => `<div class="trade-card ${trade.direction.toLowerCase()}"><div class="trade-header"><span class="trade-direction ${trade.direction.toLowerCase()}">${trade.direction}</span><span class="trade-badge">${trade.type}</span></div><div class="trade-row"><span class="trade-label">Entry</span><span class="trade-value">${trade.entry}</span></div><div class="trade-row"><span class="trade-label">Stop</span><span class="trade-value trade-stop">${trade.stop}</span></div><div class="trade-row"><span class="trade-label">Target</span><span class="trade-value trade-target">${trade.target1} / ${trade.target2}</span></div><div class="trade-rationale">${trade.rationale}</div></div>`).join('');
        }
        
        function updateLondonOpen() {
            const londonData = { bias: 'BULLISH', asiaHigh: 25680, asiaLow: 25520, candleHigh: 25650, candleLow: 25580, swept: 'ASIA_LOW', signal: 'Look for long pullback at 9:30 NY' };
            document.getElementById('londonOpen').innerHTML = `<div class="trade-card long"><div class="trade-header"><span class="trade-direction long">${londonData.bias}</span><span class="trade-badge">6AM H4 Candle</span></div><div class="trade-row"><span class="trade-label">Asia High</span><span class="trade-value">${londonData.asiaHigh}</span></div><div class="trade-row"><span class="trade-label">Asia Low</span><span class="trade-value">${londonData.asiaLow}</span></div><div class="trade-row"><span class="trade-label">6AM High</span><span class="trade-value">${londonData.candleHigh}</span></div><div class="trade-row"><span class="trade-label">6AM Low</span><span class="trade-value">${londonData.candleLow}</span></div><div class="trade-row"><span class="trade-label">Swept</span><span class="trade-value">${londonData.swept}</span></div><div class="trade-rationale">${londonData.signal}</div></div>`;
        }
        
        function updateSessionLevels(price) {
            const sessions = [
                { name: 'Asian Session', icon: 'üóº', high: 25680, low: 25520 },
                { name: 'European Session', icon: 'üá™üá∫', high: 25750, low: 25580 },
                { name: 'NY Session', icon: 'üá∫üá∏', high: 25800, low: 25620 },
                { name: 'Current Day', icon: 'üìÖ', high: 25890, low: 25380 },
            ];
            document.getElementById('sessionLevels').innerHTML = sessions.map(s => `<div class="session-item"><span class="session-name"><span class="session-icon">${s.icon}</span>${s.name}</span><div class="session-levels"><span class="session-hl up">H: ${s.high}</span><span class="session-hl down">L: ${s.low}</span></div></div>`).join('');
        }
        
        function updateVolumeProfile(price) {
            const zones = [
                { price: 25700, vol: 12000, type: 'sell' },
                { price: 25650, vol: 25000, type: 'neutral' },
                { price: 25600, vol: 35000, type: 'buy' },
                { price: 25550, vol: 28000, type: 'neutral' },
                { price: 25500, vol: 15000, type: 'sell' },
            ];
            const totalVol = zones.reduce((sum, z) => sum + z.vol, 0);
            document.getElementById('volumeProfile').innerHTML = `<div class="profile-bar">${zones.map(z => `<div class="${z.type}" style="width: ${(z.vol/totalVol)*100}%"></div>`).join('')}</div>${zones.map(z => `<div class="indicator-row"><span class="indicator-name">${z.price}</span><span class="indicator-value">${z.vol.toLocaleString()} contracts</span></div>`).join('')}<div style="margin-top: 10px; font-size: 11px; color: #8b949e; text-align: center;">POC: 25,600 | Value Area: 25,550-25,650</div>`;
        }
        
        function updateVixData(vix) {
            document.getElementById('vixData').innerHTML = `<div class="indicator-row"><span class="indicator-name">VIX</span><span class="indicator-value">${vix.toFixed(2)}</span></div><div class="indicator-row"><span class="indicator-name">VIX Term Structure</span><span class="indicator-value neutral">Contango</span></div><div class="indicator-row"><span class="indicator-name">VIX1M</span><span class="indicator-value">17.2</span></div><div class="indicator-row"><span class="indicator-name">VIX3M</span><span class="indicator-value">16.8</span></div><div class="indicator-row"><span class="indicator-name">Risk Sentiment</span><span class="indicator-value bullish">Complacent</span></div>`;
        }
        
        function updateGapData(price) {
            const gaps = [
                { type: 'Gap Up', level: 25720, fill: 40 },
                { type: 'Gap Down', level: 25580, fill: 100 },
                { type: 'Gap Down', level: 25450, fill: 0 },
            ];
            document.getElementById('gapData').innerHTML = gaps.map(g => `<div class="gap-item"><span>${g.type} @ ${g.level}</span><span class="gap-fill ${g.fill === 100 ? 'filled' : 'pending'}">${g.fill}% Filled</span></div>`).join('') + `<div style="margin-top: 10px; font-size: 11px; color: #8b949e; text-align: center;">Gap fill probability: 65% (historical avg)</div>`;
        }
        
        function updateAdrData() {
            document.getElementById('adrData').innerHTML = `<div class="indicator-row"><span class="indicator-name">ADR (20)</span><span class="indicator-value">185 pts</span></div><div class="indicator-row"><span class="indicator-name">ATR (14)</span><span class="indicator-value">165 pts</span></div><div class="indicator-row"><span class="indicator-name">Daily Range Used</span><span class="indicator-value">45%</span></div><div class="indicator-row"><span class="indicator-name">Typical True Range</span><span class="indicator-value">150-200 pts</span></div>`;
        }
        
        function updateOptionsData() {
            document.getElementById('optionsData').innerHTML = `<div class="indicator-row"><span class="indicator-name">Put/Call Ratio</span><span class="indicator-value neutral">0.85</span></div><div class="indicator-row"><span class="indicator-name">Major Strike</span><span class="indicator-value">25,650</span></div><div class="indicator-row"><span class="indicator-name">Call Wall</span><span class="indicator-value">26,000</span></div><div class="indicator-row"><span class="indicator-name">Put Support</span><span class="indicator-value">25,400</span></div><div class="indicator-row"><span class="indicator-name">IV (NQ)</span><span class="indicator-value">14.5%</span></div>`;
        }
        
        function updateOiData() {
            document.getElementById('oiData').innerHTML = `<div class="indicator-row"><span class="indicator-name">NQH26 OI</span><span class="indicator-value">245,000</span></div><div class="indicator-row"><span class="indicator-name">MNQH26 OI</span><span class="indicator-value">89,000</span></div><div class="indicator-row"><span class="indicator-name">OI Change</span><span class="indicator-value bullish">+2.3%</span></div><div class="indicator-row"><span class="indicator-name">Cost Basis</span><span class="indicator-value">25,580</span></div>`;
        }
        
        function updateDxyData(dxy) {
            document.getElementById('dxyData').innerHTML = `<div class="indicator-row"><span class="indicator-name">DXY</span><span class="indicator-value">${dxy.toFixed(2)}</span></div><div class="indicator-row"><span class="indicator-name">NQ/DXY Corr</span><span class="indicator-value bearish">-0.65</span></div><div class="indicator-row"><span class="indicator-name">10Y Yield</span><span class="indicator-value">4.52%</span></div><div class="indicator-row"><span class="indicator-name">Gold</span><span class="indicator-value">$2,045</span></div>`;
        }
        
        // Default NIFTY data
        const DEFAULT_NIFTY = { current: 25048, change: -0.95, high: 25200, low: 24950, open: 25250 };
        
        // Liquidation candle detection (simulated - real detection needs live candle data)
        function updateLiquidationData() {
            const candles = [
                { timeframe: '15M', type: 'BEARISH', wick: 'Long Lower', body: 'Small', level: 25620, confidence: 'HIGH', note: 'Swept liquidity, rejected' },
                { timeframe: '1H', type: 'NEUTRAL', wick: 'Moderate', body: 'Large', level: 25650, confidence: 'LOW', note: 'No clear rejection' },
                { timeframe: '4H', type: 'BULLISH', wick: 'Long Upper', body: 'Small', level: 25680, confidence: 'MEDIUM', note: 'Rejected at resistance' },
            ];
            
            document.getElementById('liquidationData').innerHTML = `
                <div style="margin-bottom: 12px; font-size: 11px; color: #8b949e;">
                    Long wick + small body = institutional rejection
                </div>
                ${candles.map(c => `
                    <div class="indicator-row" style="border-bottom: 1px solid #21262d; padding: 8px 0;">
                        <span class="indicator-name">${c.timeframe}</span>
                        <span class="indicator-value ${c.type.toLowerCase()}">${c.type}</span>
                        <span class="indicator-value" style="color: #8b949e; font-size: 11px;">${c.wick}</span>
                    </div>
                    <div style="font-size: 11px; color: #8b949e; padding: 4px 0 8px; margin-left: 60px;">
                        ${c.note} ‚Ä¢ <span style="color: ${c.confidence === 'HIGH' ? '#f85149' : '#3fb950'}">${c.confidence}</span>
                    </div>
                `).join('')}
                <div style="margin-top: 12px; padding-top: 10px; border-top: 1px solid #21262d; font-size: 11px; color: #58a6ff; text-align: center;">
                    üí° Enter after candle closes ‚Ä¢ Stop beyond wick ‚Ä¢ Target 2R
                </div>
            `;
        }
        
        function updateNiftyData(data) {
            const nifty = data || DEFAULT_NIFTY;
            const changeClass = nifty.change >= 0 ? 'bullish' : 'bearish';
            const changeSign = nifty.change >= 0 ? '+' : '';
            document.getElementById('niftyData').innerHTML = `
                <div class="indicator-row"><span class="indicator-name">NIFTY 50</span><span class="indicator-value" style="font-size: 18px;">${nifty.current.toLocaleString()}</span></div>
                <div class="indicator-row"><span class="indicator-name">Change</span><span class="indicator-value ${changeClass}">${changeSign}${nifty.change}%</span></div>
                <div class="indicator-row"><span class="indicator-name">Day High</span><span class="indicator-value">${nifty.high.toLocaleString()}</span></div>
                <div class="indicator-row"><span class="indicator-name">Day Low</span><span class="indicator-value">${nifty.low.toLocaleString()}</span></div>
                <div class="indicator-row"><span class="indicator-name">Open</span><span class="indicator-value">${nifty.open.toLocaleString()}</span></div>
                <div style="margin-top: 10px; font-size: 11px; color: #8b949e; text-align: center;">
                    SGX Nifty: ${(nifty.current + 50).toLocaleString()} (overnight indicator)
                </div>
            `;
        }
        
        function updateBreadthData() {
            document.getElementById('breadthData').innerHTML = `<div class="breadth-item"><span>NYSE A/D</span><span style="color: #3fb950;">+1,245</span></div><div class="breadth-bar"><div class="breadth-bar-fill up" style="width: 58%"></div></div><div class="breadth-item"><span>NASDAQ A/D</span><span style="color: #3fb950;">+892</span></div><div class="breadth-bar"><div class="breadth-bar-fill up" style="width: 55%"></div></div><div class="breadth-item"><span>SPX McGinley</span><span class="indicator-value neutral">Strong</span></div><div class="indicator-row" style="margin-top: 10px;"><span class="indicator-name">UVOL/DVOL</span><span class="indicator-value">1.12</span></div>`;
        }
        
        async function updatePriceAlerts(prices) {
            const priceAlerts = [
                { ticker: 'TSLA', current: prices.tsla.current, threshold: prices.tsla.current * 0.95, type: 'drop' },
                { ticker: 'NQ', current: prices.nq.current, threshold: prices.nq.current - 100, type: 'drop' },
            ];
            const sweepAlerts = [
                { timeframe: '1H', high: 25680, low: 25580, close: prices.nq.current, dir: prices.nq.current > 25680 ? 'BULLISH' : (prices.nq.current < 25580 ? 'BEARISH' : 'NEUTRAL') },
                { timeframe: '4H', high: 25750, low: 25450, close: prices.nq.current, dir: 'NEUTRAL' },
                { timeframe: 'Prev Day', high: 25890, low: 25380, close: 25650, dir: 'PDH/PDL' },
            ];
            let html = '<div style="margin-bottom: 15px;"><strong style="font-size: 12px; color: #8b949e;">üìâ Price Drops</strong></div>';
            html += priceAlerts.map(alert => {
                const status = alert.current <= alert.threshold ? 'TRIGGERED' : 'ACTIVE';
                const statusClass = alert.current <= alert.threshold ? 'bearish' : 'neutral';
                return `<div class="indicator-row"><span class="indicator-name">${alert.ticker}</span><span class="indicator-value ${statusClass}">${alert.current.toFixed(2)} / ${alert.threshold.toFixed(2)} (${status})</span></div>`;
            }).join('');
            html += '<div style="margin: 15px 0 10px;"><strong style="font-size: 12px; color: #8b949e;">üïØÔ∏è Candle Sweeps (NQ)</strong></div>';
            html += sweepAlerts.map(sweep => {
                const sweepClass = sweep.dir === 'BULLISH' ? 'bullish' : (sweep.dir === 'BEARISH' ? 'bearish' : 'neutral');
                return `<div class="indicator-row"><span class="indicator-name">${sweep.timeframe}</span><span class="indicator-value ${sweepClass}">H: ${sweep.high} | L: ${sweep.low} | C: ${sweep.close.toFixed(0)}</span></div>`;
            }).join('');
            html += '<div style="margin-top: 15px; padding-top: 10px; border-top: 1px solid #21262d; font-size: 11px; color: #8b949e; text-align: center;">Live data ‚Ä¢ Updating every 30s</div>';
            document.getElementById('priceAlerts').innerHTML = html;
        }
        
        function updateIndicators() {
            const indicators = [
                { name: 'MA 200', value: '25,200', signal: 'Bullish' },
                { name: 'MA 50', value: '25,500', signal: 'Neutral' },
                { name: 'RSI (14)', value: '48', signal: 'Neutral' },
                { name: 'MACD', value: 'Slightly Bearish', signal: 'Bearish' },
                { name: 'VWAP', value: '25,580', signal: 'Neutral' },
            ];
            document.getElementById('indicators').innerHTML = indicators.map(ind => `<div class="indicator-row"><span class="indicator-name">${ind.name}</span><span class="indicator-value ${ind.signal.toLowerCase()}">${ind.value} (${ind.signal})</span></div>`).join('');
        }
        
        function updateGlobalIndices() {
            const indices = [
                { name: 'Nikkei 225', icon: 'üóº', price: 39250, change: -180 },
                { name: 'DAX', icon: 'üá©üá™', price: 20890, change: +45 },
                { name: 'FTSE 100', icon: 'üá¨üáß', price: 8120, change: +28 },
                { name: 'S&P 500', icon: 'üá∫üá∏', price: 6795, change: +12 },
            ];
            document.getElementById('globalIndices').innerHTML = indices.map(idx => `<div class="global-index-item"><div class="index-info"><span class="index-icon">${idx.icon}</span><span class="index-name">${idx.name}</span></div><span class="index-price">${idx.price.toLocaleString()}</span><span class="index-change ${idx.change >= 0 ? 'up' : 'down'}">${idx.change >= 0 ? '‚ñ≤' : '‚ñº'} ${idx.change >= 0 ? '+' : ''}${idx.change}</span></div>`).join('');
        }
        
        // Countdown to US Market Open (9:30 AM ET = 8:00 PM IST)
        function updateMarketTimer() {
            const now = new Date();
            const istNow = new Date(now.getTime() + 5.5 * 60 * 60 * 1000);
            const currentISTHour = istNow.getUTCHours() + istNow.getUTCMinutes() / 60;
            
            // US market opens at 20:00 IST (8:00 PM)
            const marketOpenIST = 20.0;
            
            let timerHtml = '';
            if (currentISTHour < 14.5 || currentISTHour >= 23) {
                // Market closed, show countdown to open
                let hoursToOpen = marketOpenIST - currentISTHour;
                if (hoursToOpen < 0) hoursToOpen += 24; // Next day
                
                const hrs = Math.floor(hoursToOpen);
                const mins = Math.floor((hoursToOpen - hrs) * 60);
                const secs = Math.floor(((hoursToOpen - hrs) * 60 - mins) * 60);
                
                timerHtml = `<span style="color: #58a6ff;">‚è∞ Opens in ${hrs}h ${mins}m ${secs}s</span>`;
            } else if (currentISTHour >= 14.5 && currentISTHour < 23) {
                // Market is open
                const closeHour = 23;
                const hoursOpen = closeHour - currentISTHour;
                const hrs = Math.floor(hoursOpen);
                const mins = Math.floor((hoursOpen - hrs) * 60);
                const secs = Math.floor(((hoursOpen - hrs) * 60 - mins) * 60);
                
                timerHtml = `<span style="color: #3fb950;">‚óè LIVE ${hrs}h ${mins}m ${secs}s left</span>`;
            }
            
            const timerEl = document.getElementById('marketTimer');
            if (timerEl) timerEl.innerHTML = timerHtml;
        }
        
        function updateMarketRisks() {
            const risks = [
                { icon: 'üìã', text: 'FOMC Minutes (Wed)', badge: 'HIGH' },
                { icon: 'üìä', text: 'PCE Inflation (Thu)', badge: 'HIGH' },
                { icon: 'üìà', text: 'Jobs Report (Fri)', badge: 'HIGH' },
                { icon: 'üîÆ', text: 'Megacap Earnings', badge: 'MEDIUM' },
            ];
            document.getElementById('marketRisks').innerHTML = risks.map(r => `<div class="risk-item"><span class="risk-icon">${r.icon}</span><span class="risk-text">${r.text}</span><span class="risk-badge high">${r.badge}</span></div>`).join('');
        }
        
        function formatTime12(str) {
            const [h, m] = str.split(':').map(Number);
            const ampm = h >= 12 ? 'PM' : 'AM';
            const h12 = h % 12 || 12;
            return h12 + ':' + m.toString().padStart(2, '0') + ' ' + ampm;
        }
        
        function updateEconomicEvents() {
            const events = [
                { time: '18:30', name: 'Dallas Fed Mfg', impact: 'medium' },
                { time: '20:30', name: 'Durable Goods', impact: 'medium' },
                { time: '22:00', name: 'Bowman Speech', impact: 'high' },
            ];
            document.getElementById('economicEvents').innerHTML = events.map(e => `<div class="event-item"><span class="event-time">${formatTime12(e.time)} IST</span><span class="event-name">${e.name}</span><span class="event-impact ${e.impact}">${e.impact.toUpperCase()}</span></div>`).join('');
        }
        
        function updateEarnings() {
            const earnings = [
                { ticker: 'TSLA', date: 'Wed', name: 'Tesla' },
                { ticker: 'MSFT', date: 'Wed', name: 'Microsoft' },
                { ticker: 'META', date: 'Wed', name: 'Meta' },
                { ticker: 'AAPL', date: 'Thu', name: 'Apple' },
            ];
            document.getElementById('earnings').innerHTML = earnings.map(e => `<div class="earnings-item"><span><span class="ticker">${e.ticker}</span> - ${e.name}</span><span class="date">${e.date}</span></div>`).join('');
        }
        
        function updateNews() {
            const news = [
                { headline: 'Fed officials signal patience on rate cuts', source: 'Reuters' },
                { headline: 'Nasdaq consolidates amid earnings week', source: 'CNBC' },
            ];
            document.getElementById('news').innerHTML = news.map(n => `<div class="news-item"><div class="news-headline">${n.headline}</div><div class="news-source">${n.source}</div></div>`).join('');
        }
        
        function format12Hour(hour24) {
            const h = Math.floor(hour24) % 24;
            const ampm = h >= 12 ? 'PM' : 'AM';
            const h12 = h % 12 || 12;
            return h12 + ':00 ' + ampm;
        }
        
        function updateGlobalTimes() {
            const now = new Date();
            const istOffset = 5.5 * 60 * 60 * 1000;
            const istNow = new Date(now.getTime() + istOffset);
            const istHour = istNow.getHours() + istNow.getMinutes() / 60;
            const tokyoHour = (istHour - 3.5 + 24) % 24;
            const londonHour = (istHour - 5.5 + 24) % 24;
            const frankfurtHour = (istHour - 4.5 + 24) % 24;
            const nyHour = (istHour - 10.5 + 24) % 24;
            document.getElementById('tokyoTime').textContent = format12Hour(tokyoHour);
            document.getElementById('londonTime').textContent = format12Hour(londonHour);
            document.getElementById('frankfurtTime').textContent = format12Hour(frankfurtHour);
            document.getElementById('nyTime').textContent = format12Hour(nyHour);
        }
        
        async function updatePrice() {
            const prices = await fetchPrices();
            const price = prices.nq.current;
            document.getElementById('price').textContent = price.toLocaleString();
            document.getElementById('res1').textContent = (price + 100).toLocaleString();
            document.getElementById('res2').textContent = (price + 200).toLocaleString();
            document.getElementById('sup1').textContent = (price - 100).toLocaleString();
            document.getElementById('sup2').textContent = (price - 200).toLocaleString();
        }
        
        function formatDateTime12(d) {
            const h = d.getHours();
            const m = d.getMinutes();
            const ampm = h >= 12 ? 'PM' : 'AM';
            const h12 = h % 12 || 12;
            return h12 + ':' + m.toString().padStart(2, '0') + ' ' + ampm + ' IST';
        }
        
        async function fetchAllData() {
            try {
                const now = new Date();
                document.getElementById('updateTime').textContent = formatDateTime12(now);
                
                const hour = now.getUTCHours() + now.getMinutes() / 60;
                const isOpen = hour >= 14.5 && hour < 23 && now.getDay() > 0 && now.getDay() < 6;
                const statusHtml = isOpen ? '<span class="status-indicator" style="background: #3fb950;"></span><span class="market-open">‚óè US Market OPEN</span>' : '<span class="status-indicator" style="background: #f85149;"></span><span class="market-closed">‚óè US Market CLOSED</span>';
                document.getElementById('marketStatus').innerHTML = statusHtml + '<div id="marketTimer"></div>';
                
                updateMarketTimer();
                updateGlobalTimes();
                
                const prices = await fetchPrices();
                await updatePrice();
                
                updateTradeIdeas();
                updateLondonOpen();
                updatePriceAlerts(prices);
                updateSessionLevels(prices.nq.current);
                updateVolumeProfile(prices.nq.current);
                updateVixData(prices.vix.current);
                updateGapData(prices.nq.current);
                updateAdrData();
                updateOptionsData();
                updateOiData();
                updateDxyData(prices.dxy.current);
                updateBreadthData();
                updateIndicators();
                updateGlobalIndices();
                updateNiftyData(prices.nifty);
                updateLiquidationData();
                updateMarketRisks();
                updateEconomicEvents();
                updateEarnings();
                updateNews();
            } catch (e) {
                console.error('Error:', e);
            }
        }
        
        // Populate data immediately with defaults
        (function initDashboard() {
            console.log('Initializing dashboard...');
            
            // Default prices
            const prices = {
                tsla: { current: 449.06, change: -0.07 },
                nq: { current: 25650, change: 0.12 },
                vix: { current: 16.5, change: -2.1 },
                dxy: { current: 108.5, change: 0.15 },
                nifty: DEFAULT_NIFTY
            };
            
            // Add IDs to cards and update all sections
            const cardConfigs = [
                { id: 'card-nq-levels', fn: () => {} },
                { id: 'card-trade-ideas', fn: updateTradeIdeas },
                { id: 'card-london-open', fn: updateLondonOpen },
                { id: 'card-price-alerts', fn: () => updatePriceAlerts(prices) },
                { id: 'card-session-levels', fn: () => updateSessionLevels(prices.nq.current) },
                { id: 'card-volume-profile', fn: () => updateVolumeProfile(prices.nq.current) },
                { id: 'card-vix-data', fn: () => updateVixData(prices.vix.current) },
                { id: 'card-gap-data', fn: () => updateGapData(prices.nq.current) },
                { id: 'card-adr-data', fn: updateAdrData },
                { id: 'card-options-data', fn: updateOptionsData },
                { id: 'card-oi-data', fn: updateOiData },
                { id: 'card-dxy-data', fn: () => updateDxyData(prices.dxy.current) },
                { id: 'card-breadth-data', fn: updateBreadthData },
                { id: 'card-indicators', fn: updateIndicators },
                { id: 'card-global-indices', fn: updateGlobalIndices },
                { id: 'card-nifty-data', fn: () => updateNiftyData(prices.nifty) },
                { id: 'card-liquidation', fn: updateLiquidationData },
                { id: 'card-market-risks', fn: updateMarketRisks },
                { id: 'card-economic-events', fn: updateEconomicEvents },
                { id: 'card-earnings', fn: updateEarnings },
                { id: 'card-news', fn: updateNews }
            ];
            
            // Apply IDs and run functions
            const grid = document.getElementById('dashboardGrid');
            const cardDivs = grid.querySelectorAll('.card');
            cardConfigs.forEach((config, index) => {
                if (cardDivs[index]) {
                    cardDivs[index].id = config.id;
                }
                config.fn();
            });
            
            console.log('Dashboard initialized with default data');
        })();
        
        // Fetch live data in background
        fetchAllData();
        setInterval(() => fetchAllData(), UPDATE_INTERVAL);
        
        // Initialize drag-and-drop with SortableJS
        document.addEventListener('DOMContentLoaded', function() {
            const grid = document.getElementById('dashboardGrid');
            const lockBtn = document.getElementById('lockBtn');
            
            // Restore saved order from localStorage
            const savedOrder = localStorage.getItem('dashboardOrder');
            if (savedOrder) {
                try {
                    const cardIds = JSON.parse(savedOrder);
                    cardIds.forEach(id => {
                        const card = document.getElementById(id);
                        if (card) grid.appendChild(card);
                    });
                } catch (e) {}
            }
            
            // Initialize Sortable
            const sortable = new Sortable(grid, {
                animation: 150,
                handle: '.card',
                ghostClass: 'sortable-ghost',
                dragClass: 'sortable-drag',
                onEnd: function(evt) {
                    const cardIds = Array.from(grid.children).map(card => card.id);
                    localStorage.setItem('dashboardOrder', JSON.stringify(cardIds));
                }
            });
            
            // Lock toggle function
            window.toggleLock = function() {
                const isLocked = sortable.option('disabled');
                sortable.option('disabled', !isLocked);
                
                if (!isLocked) {
                    // Locking
                    lockBtn.textContent = 'üîí Lock';
                    lockBtn.style.borderColor = '#f85149';
                    lockBtn.style.color = '#f85149';
                    localStorage.setItem('dashboardLocked', 'true');
                    grid.style.opacity = '0.7';
                } else {
                    // Unlocking
                    lockBtn.textContent = 'üîì Unlock';
                    lockBtn.style.borderColor = '#30363d';
                    lockBtn.style.color = '#8b949e';
                    localStorage.setItem('dashboardLocked', 'false');
                    grid.style.opacity = '1';
                }
            };
            
            // Check saved lock state
            const wasLocked = localStorage.getItem('dashboardLocked') === 'true';
            if (wasLocked) {
                sortable.option('disabled', true);
                lockBtn.textContent = 'üîí Lock';
                lockBtn.style.borderColor = '#f85149';
                lockBtn.style.color = '#f85149';
                grid.style.opacity = '0.7';
            }
        });
        
        // Side Tab Functions
        window.toggleSidePanel = function() {
            const panel = document.getElementById('sidePanel');
            panel.classList.toggle('open');
        }
        
        // Load non-trading data
        function updateSidePanel() {
            // Cricket Scores (Simulated)
            const cricketMatches = [
                { team1: 'IND', team2: 'ENG', score1: '312/3', score2: 'Trailing', status: '3rd Day' },
                { team1: 'RCB', team2: 'CSK', score1: '185/6', score2: 'Yet to bat', status: 'IPL Warmup' },
            ];
            document.getElementById('cricketData').innerHTML = cricketMatches.map(m => `
                <div class="ao-match">
                    <div class="ao-match-player"><span>${m.team1}</span><span class="ao-score">${m.score1}</span></div>
                    <div class="ao-match-player"><span>${m.team2}</span><span style="color: #8b949e;">${m.score2}</span></div>
                    <div style="font-size: 10px; color: #58a6ff; margin-top: 4px;">${m.status}</div>
                </div>
            `).join('');
            
            // India News (Simulated)
            const indiaNews = [
                { headline: 'RBI keeps repo rate unchanged at 6.5%', source: 'ET' },
                { headline: 'Sensex closes at record high', source: 'BS' },
                { headline: 'India Inc. Q3 earnings beat expectations', source: 'FE' },
            ];
            document.getElementById('indiaNews').innerHTML = indiaNews.map(n => `
                <div style="padding: 6px 0; border-bottom: 1px solid #21262d;">
                    <div style="font-size: 12px;">${n.headline}</div>
                    <div style="font-size: 10px; color: #8b949e;">${n.source}</div>
                </div>
            `).join('');
            
            // Bengaluru News (Simulated)
            const bangaloreNews = [
                { headline: 'Metro phase 2 expansion approved', source: 'TOI' },
                { headline: 'Bangalore tech hub sees new IPOs', source: 'ET' },
                { headline: 'Weather alert: Light rain expected', source: 'IMD' },
            ];
            document.getElementById('bangaloreNews').innerHTML = bangaloreNews.map(n => `
                <div style="padding: 6px 0; border-bottom: 1px solid #21262d;">
                    <div style="font-size: 12px;">${n.headline}</div>
                    <div style="font-size: 10px; color: #8b949e;">${n.source}</div>
                </div>
            `).join('');
            
            // Australian Open
            const aoScores = [
                { p1: 'Sinner', p2: 'Darderi', s1: '6-1', s2: '6-3', s3: '7-6', winner: 1 },
                { p1: 'Shelton', p2: 'Ruud', s1: '3-6', s2: '6-4', s3: '6-3', s4: '6-4', winner: 1 },
                { p1: 'Swiatek', p2: 'Inglis', s1: '6-0', s2: '6-3', winner: 1 },
            ];
            document.getElementById('aoScores').innerHTML = aoScores.map(m => `
                <div class="ao-match">
                    <div class="ao-match-player"><span>${m.p1}</span><span class="ao-score">${m.s1}</span></div>
                    <div class="ao-match-player"><span>${m.p2}</span><span class="ao-score">${m.s2}</span></div>
                    ${m.s3 ? `<div class="ao-match-player" style="color: #8b949e; font-size: 11px;">${m.s3}${m.s4 ? ' / ' + m.s4 : ''}</div>` : ''}
                </div>
            `).join('');
            
            // Weather (Bangalore)
            document.getElementById('weatherData').innerHTML = `
                <div class="weather-item"><span class="weather-icon">‚òÄÔ∏è</span><span>Bangalore</span><span class="weather-temp">28¬∞C</span></div>
                <div class="weather-item"><span class="weather-icon">üåô</span><span> Tonight</span><span>22¬∞C</span></div>
            `;
            
            // Crypto
            document.getElementById('cryptoData').innerHTML = `
                <div class="side-item"><span>‚Çø Bitcoin</span><span style="color: #3fb950;">$104,250 (+2.1%)</span></div>
                <div class="side-item"><span>Œû Ethereum</span><span style="color: #3fb950;">$3,420 (+1.8%)</span></div>
                <div class="side-item"><span>‚óé Solana</span><span style="color: #f85149;">$175 (-0.5%)</span></div>
            `;
        }
        
        // Initialize side panel
        document.addEventListener('DOMContentLoaded', updateSidePanel);
        
        // Update timer every second
        setInterval(updateMarketTimer, 1000);
        updateMarketTimer(); // Initial call
    </script>
    
    <!-- Side Tab -->
    <div class="side-tab">
        <button class="side-tab-btn" onclick="toggleSidePanel()">MORE ‚ñ™</button>
    </div>
    
    <!-- Side Panel -->
    <div class="side-panel" id="sidePanel">
        <h2>üìã Extras <button class="side-panel-close" onclick="toggleSidePanel()">√ó</button></h2>
        
        <div class="side-section">
            <h3>üèè Cricket</h3>
            <div id="cricketData">Loading...</div>
        </div>
        
        <div class="side-section">
            <h3>üáÆüá≥ India News</h3>
            <div id="indiaNews">Loading...</div>
        </div>
        
        <div class="side-section">
            <h3>üáÆüá≥ Bengaluru News</h3>
            <div id="bangaloreNews">Loading...</div>
        </div>
        
        <div class="side-section">
            <h3>üéæ Australian Open</h3>
            <div id="aoScores">Loading...</div>
        </div>
        
        <div class="side-section">
            <h3>üå§Ô∏è Weather (Bangalore)</h3>
            <div id="weatherData">Loading...</div>
        </div>
        
        <div class="side-section">
            <h3>‚Çø Crypto</h3>
            <div id="cryptoData">Loading...</div>
        </div>
        
        <div class="side-section">
            <h3>üìÖ Reminders</h3>
            <div class="side-item"><span>Jan 29</span><span>School Fees (‚Çπ90K)</span></div>
            <div class="side-item"><span>Jan 31</span><span>PTM @ 9AM</span></div>
        </div>
    </div>
</body>
</html>
